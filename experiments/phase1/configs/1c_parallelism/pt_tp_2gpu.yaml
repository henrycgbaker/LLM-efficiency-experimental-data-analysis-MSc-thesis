# Phase 1c: Parallelism - PyTorch Tensor Parallel 2 GPU
config_name: parallel_pt_tp_2gpu
model_name: meta-llama/Llama-3.2-3B

max_input_tokens: 128
max_output_tokens: 128
num_input_prompts: 128

gpus: [0, 1]
num_processes: 2
num_cycles: 6  # 1 warm-up + 5 measurement

fp_precision: float16

batching:
  batch_size: 8
  strategy: static

decoder:
  preset: deterministic

quantization:
  quantization: false

sharding:
  strategy: tensor_parallel
  num_shards: 2
  tp_plan: auto

prompts:
  type: huggingface
  dataset: ai-energy-score
  split: train
  sample_size: 128
